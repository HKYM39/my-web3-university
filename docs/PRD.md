---
# **Web3 大学平台 PRD（正式版 v1.0）**

---

# **1. 产品概要（Product Overview）**

## **1.1 产品名称**

Web3 大学平台（Web3 University Platform）

## **1.2 产品简介**

Web3 大学是一个基于 Web3 技术构建的在线学习平台，通过区块链技术实现课程访问权 NFT 化、收益透明分配、代币经济激励、创作者资产链上管理等全新学习生态。

平台依托链上身份（钱包地址）、课程 NFT、平台代币 YIDENG 以及 AAVE 收益管理，创建一个学习激励与内容创作可持续的知识经济模型。

---

# **2. 产品目标**

## **2.1 核心目标**

| 目标                | 说明                           |
| ----------------- | ---------------------------- |
| 建立链上课程体系          | 课程访问权通过 NFT（SBT）记录并防伪可验证     |
| 支撑创作者收入透明化        | 所有购买记录链上可查，不可篡改              |
| 创作者可自主管理资产收益      | 支持将课程收入质押 AAVE 获得稳定收益        |
| 激励用户积极学习          | 引入学习挖矿，奖励型代币机制               |
| 提供用户友好的 Web3 学习平台 | 支持 MetaMask 登录、签名更新资料、链上数据查询 |

## **2.2 成功指标（KPIs）**

| 指标             | 目标          |
| -------------- | ----------- |
| 注册用户钱包数        | ≥ 20,000    |
| 完成购买课程的用户占比    | ≥ 15%       |
| 创作者质押 AAVE 的人数 | ≥ 10% 创作者   |
| 课程购买成功率        | ≥ 99%       |
| 用户平均学习时长       | ≥ 20 分钟 / 天 |
| 合约执行失败率        | < 0.2%      |

---

# **3. 用户角色（User Personas）**

| 角色              | 描述与痛点                    | 在平台的目标         |
| --------------- | ------------------------ | -------------- |
| 学习者（Learner）    | 想学习有价值的课程，通过链上身份获取长期访问权限 | 购买课程、学习、获得代币奖励 |
| 课程作者（Creator）   | 希望内容透明变现，并对收益进行链上管理      | 创建课程、获得收入、质押收益 |
| 平台管理员（Admin）    | 管理课程质量与平台运行              | 对课程进行审核与推荐     |
| 合约开发者（Internal） | 负责智能合约开发与审核              | 确保平台合约安全与可扩展性  |

---

# **4. 业务需求**

---

# **4.1 功能性需求（Functional Requirements）**

## **4.1.1 用户钱包登录模块**

| 编号     | 需求             | 描述                |
| ------ | -------------- | ----------------- |
| FR-001 | 支持 MetaMask 登录 | 用户可授权连接钱包作为账户     |
| FR-002 | 签名登录机制         | 通过 nonce 防重放，确保安全 |

---

## **4.1.2 平台代币（YIDENG Token）**

| 编号     | 需求          | 描述              |
| ------ | ----------- | --------------- |
| FR-010 | 使用 ERC20 标准 | 代币可用于支付课程、奖励用户  |
| FR-011 | 支持授权与转账     | 用于购买课程和 staking |

---

## **4.1.3 课程系统**

### 创建课程

| 编号     | 需求     | 描述              |
| ------ | ------ | --------------- |
| FR-020 | 创建课程   | 作者填写课程信息并上链     |
| FR-021 | 设置课程价格 | 支持 YIDENG / ETH |
| FR-022 | 课程审核流程 | 管理员审核后上架        |

### 购买课程

| 编号     | 需求       | 描述                |
| ------ | -------- | ----------------- |
| FR-023 | 使用代币购买课程 | 用户可通过 YIDENG 购买课程 |
| FR-024 | 发放课程 NFT | 购买成功后自动 mint SBT  |
| FR-025 | 检查重复购买   | 已购买用户不能重复支付       |

---

## **4.1.4 AAVE 质押模块**

| 编号     | 需求             | 描述                     |
| ------ | -------------- | ---------------------- |
| FR-030 | 支持 ETH、USDT 质押 | 兼容 AAVE V3 supply() 接口 |
| FR-031 | 展示 APY、余额      | 从链上读取 aToken 数量与收益     |
| FR-032 | 支持赎回           | 作者可 withdraw() 提取本金收益  |

---

## **4.1.5 用户中心**

| 编号     | 需求         | 描述           |
| ------ | ---------- | ------------ |
| FR-040 | 显示用户基础信息   | 昵称、钱包、NFT 列表 |
| FR-041 | 修改昵称（签名验证） | 通过签名消息实现     |
| FR-042 | 查看已购课程     | 从 NFT 合约读取   |

---

## **4.1.6 学习挖矿系统**

| 编号     | 需求     | 描述               |
| ------ | ------ | ---------------- |
| FR-050 | 学习进度判断 | 完成 80% 视频才能领取奖励  |
| FR-051 | 发放奖励   | 调用 rewardPool 合约 |
| FR-052 | 签到学习挖矿 | 每日学习可获得少量奖励      |

---

## **4.1.7 内容运营模块**

* SEO 内容库
* 外包文章
* 平台官方文章
* 创作者文章页（知识库）

---

# **4.2 非功能性需求（NFRs）**

| 类型  | 指标                        |
| --- | ------------------------- |
| 性能  | 页面白屏时间 < 2s               |
| 安全  | 所有合约通过审计，无管理员私自改写用户资产权限   |
| 可用性 | 99.5% 平台可用度               |
| 扩展性 | 模块化合约架构（Upgradable Proxy） |
| 合规  | 遵守当地数字资产存储法规，不托管用户资产      |

---

# **5. 系统流程设计**

---

## **5.1 用户购买课程流程**

```
用户连接钱包 → 授权代币 → buyCourse() → 扣费 → mint NFT → 解锁课程内容
```

---

## **5.2 创作者质押收益流程**

```
查看可质押金额 → approve → AAVE supply → 成功质押 → 查看收益
```

---

## **5.3 修改昵称流程（签名验证）**

```
点击修改昵称 → 签名 “Update nickname” → 后端验证 → 更新数据库
```

---

# **6. 合约设计（Smart Contract Architecture）**

---

## **6.1 合约列表**

| 合约              | 功能           |
| --------------- | ------------ |
| YIDENGToken     | 平台 ERC20 代币  |
| CourseManager   | 课程创建、购买、逻辑控制 |
| CourseNFT (SBT) | NFT 课程凭证     |
| RewardPool      | 用户学习奖励分发     |
| AAVEAdapter     | 封装与 AAVE 的交互 |

---

## **6.2 课程购买合约伪代码**

```solidity
function buyCourse(uint256 courseId) external {
    require(!hasPurchased[msg.sender][courseId]);
    IERC20(token).transferFrom(msg.sender, author, price);
    CourseNFT.mint(msg.sender, courseId);
}
```

---

# **7. 数据库设计（ER 图）**

以下为可视化 ER 图（结构版）。如需 PNG 图，我可为你生成可视化版。

```
+------------+         +------------+          +----------------+
|   Users    | 1     N | UserCourse | N      1 |    Courses     |
+------------+         +------------+          +----------------+
| id (PK)    |---------| id (PK)    |----------| id (PK)        |
| wallet     |         | wallet(FK) |          | authorWallet   |
| nickname   |         | courseId   |          | price          |
| signature  |         | nftTokenId |          | metadata       |
+------------+         +------------+          +----------------+

+----------------+
| RewardRecords  |
+----------------+
| id (PK)        |
| userWallet (FK)|
| courseId (FK)  |
| rewardAmount   |
| timestamp      |
+----------------+
```

---

# **8. 安全与风控**

| 风险        | 风控措施                  |
| --------- | --------------------- |
| 重放攻击      | 登录签名包含 nonce          |
| NFT 倒卖    | 使用不可转让 SBT            |
| 合约权限滥用    | 使用 AccessControl 角色体系 |
| AAVE 地址伪造 | AAVEAdapter 仅允许官方地址   |
| 价格操纵      | 课程价格链上写死，不可随意变更       |

---

# **9. 项目里程碑（Milestones）**

| 阶段  | 内容            | 时间  |
| --- | ------------- | --- |
| M1  | 钱包登录 + 代币合约完成 | 2 周 |
| M2  | 课程系统 + NFT 发布 | 3 周 |
| M3  | 学习挖矿          | 1 周 |
| M4  | AAVE 质押模块集成   | 2 周 |
| M5  | 用户中心 + 运维后台   | 2 周 |
| M6  | 安全测试与审计       | 2 周 |

---

# **10. 验收标准（Acceptance Criteria）**

* 所有核心链上操作均可验证
* 课程访问权限由 NFT 精准控制
* AAVE 质押收益展示无误
* 用户 20% 学习挖矿自动发放奖励
* 管理员后台可正常上架 / 下架课程

---
